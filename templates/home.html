{% extends "layout.html" %} 
{% import "bootstrap/wtf.html" as wtf %} 

{% block title %}
{{ super()}}
- Home
{% endblock %} 

{% block page_content %}
{{ super() }}


<div class="container">
	
	<div class="col-md-12">
		{% for category, message in get_flashed_messages(with_categories=true) %} 
		<div class="alert alert-{{ category }}">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			{{ message }}
		</div>
		{% endfor %}

		</br>

		<div class="row">
			<div class="col-md-12 panel panel-success">
				<div class="panel-body">
			        </br>
			        <div class="col-md-6">
			        	<h3 class="text-success">Where are you really browsing?</h3>
			        	</br>
			        	</br>
			        	<p>Many questionable websites can be hiding behind clever domain names. </p>
			        	<p>Don't fall for their tricks. Know where you're browsing while you browse.</p>
			        </div>
			        <div class="col-md-3 pull-right">
			        	<img src="/static/earth.png" class="bottom-padding">
			        </div>
			    </div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 panel panel-success">
				<div class="panel-heading">
					<h3 class="panel-title">Find location of a domain below</h3>
				</div>
				<div class="panel-body text-center">
			        </br>
			        <form class="form-inline">
		        	   <input type="text" class="form-control" id="URL" placeholder="example.com">
		        	  <button type="submit" id="URLSubmit" class="btn btn-success">Lookup</button>
		        	</form>
			        </br>
			        <div class="results">
			        	
			        </div>
			    </div>
			</div>
		</div>

		
		
	</div>
</div>

</div>



{% endblock %}

{% block scripts %}
{{ super() }}

<script type="text/javascript">

var loading = $('<div style="text-center"><i class="fa fa-spin fa-2x text-center fa-spinner"></i></div>');

$('#URLSubmit').on('click',function(e){
	e.preventDefault();

	$('.btn-success').addClass('hide');

	$.ajax({
		type : "GET",
		url : "/geoip/" + $('input#URL').val(),
		contentType: 'application/json;charset=UTF-8',
		beforeSend: function(){
			$('.col-md-2').append(loading);
		},
		success : function(resp){
			loading.remove();
			$('.btn-success').removeClass('hide');
			$('.results').append('<p> <strong>' + resp['City'] + ' / ' + resp['Country'] + '</strong> Latitude: ' + resp['Latitude'] + ', Longitude:' + resp['Latitude'] + '</p>');
			$('input').val('');
			console.log(resp);
		},
		error : function(resp){
			alert(resp['responseText']);
       loading.remove();
		}
	});

});

</script>

{% endblock %}